{% extends 'base.html.twig' %}

{% block title %}Nos Produits
{% endblock %}

{% block body %}
	<div
		class="flex">
		{# Affichage de toutes les catégories : #}
		<aside class="w-1/4 p-10 bg-gray-100">
			<div class="rounded-lg overflow-hidden shadow-md">
				<h2 class="text-2xl font-semibold mb-4 p-4 bg-green-500 text-white">Catégories</h2>
				<ul class="p-4">
					{% for category in categories %}
						<li class="mb-2">
							<a href="{{ path('products_in_category', {'id': category.id}) }}" class="text-black hover:text-white hover:bg-green-500 transition duration-200 rounded">{{ category.name }}</a>
						</li>
					{% endfor %}
				</ul>
			</div>

			{# Formulaire de filtrage par prix avec styles personnalisés Tailwind CSS : #}
			<div class="rounded-lg overflow-hidden shadow-md mt-4 p-4 bg-gray-200">
				<h2 class="text-2xl font-semibold mb-4">Filtrer par Prix</h2>
				<form action="{{ path('api_products_filter') }}" method="get" class="space-y-4">
					<div class="flex items-center space-x-4">
						<label for="price_min" class="w-20 text-gray-600">Prix min:</label>
						<input type="number" name="price_min" id="price_min" value="{{ priceMin ?? '' }}" class="w-1/2 border rounded-md py-2 px-3 focus:outline-none focus:ring focus:border-blue-300" min="0"/>
					</div>

					<div class="flex items-center space-x-4">
						<label for="price_max" class="w-20 text-gray-600">Prix max:</label>
						<input type="number" name="price_max" id="price_max" value="{{ priceMax ?? '' }}" class="w-1/2 border rounded-md py-2 px-3 focus:outline-none focus:ring focus:border-blue-300" min="0"/>
					</div>

					<button type="submit" class="bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-700">Filtrer</button>
				</form>
			</div>


		</aside>


		<main class="flex-1">
			<h2 class="text-2xl font-semibold mb-4">Tous nos Produits</h2>


			{# Affichage des produits #}
			<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
				{% for product in products %}
					<div class="bg-white rounded-lg overflow-hidden shadow-md transition duration-300 transform hover:scale-105">
						<a href="{{ path('api_product', {'id': product.id}) }}">
							<div class="flex overflow-hidden">
								{% for image in product.images %}
									<img src="{{ image }}" alt="{{ product.title }}" class="w-1/3 h-48 object-cover">
								{% endfor %}
							</div>
						</a>
						<div class="p-4">
							<h3 class="text-xl font-semibold mb-2">{{ product.title }}</h3>
							<p class="text-gray-700">{{ product.description | slice(0, 50) ~ '...' }}</p>
							<p class="text-green-500 font-semibold mt-2">Prix :
								{{ product.price }}€</p>
							{# Lien vers la catégorie : #}
							<p class="text-blue-500 font-semibold mt-2">Catégorie :
								<a href="{{ path('api_products', {'category': product.category.id}) }}" class="text-blue-500 hover:underline">{{ product.category.name }}</a>
							</p>
							<button class="mt-4 bg-green-500 text-white px-4 py-2 rounded-full">Ajouter au panier</button>
						</div>

					</div>
				{% endfor %}

			</div>
		</main>
	</div>
{% endblock %}
